{
    email admin@builders-tech.com
    auto_https off
}

:80 {
    encode gzip

    # API -> backend
    handle_path /api/* {
        reverse_proxy backend:3002
    }

    # Admin UI -> frontend
    handle_path /admin-new/* {
        reverse_proxy frontend:5174
    }

    handle /admin-new {
        redir /admin-new/ 308
    }

    # Optional: root -> admin
    handle / {
        redir /admin-new/ 308
    }

    log {
        output stdout
        format json
    }
}